<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <title>Wishlist</title>
  <style>
    body { font-family: sans-serif; max-width: 800px; margin: auto; padding: 2rem; }
    img { max-width: 150px; display: block; }
    li { margin-bottom: 2rem; list-style: none; border-bottom: 1px solid #ccc; padding-bottom: 1rem; }
    .taken { opacity: 0.5; }
    button { margin-top: 0.5rem; }
  </style>
</head>
<body>
  <h1>üéÅ Wishlist</h1>
  <ul id="wishlist">Naƒç√≠t√°n√≠...</ul>

  <script>
    const storageKey = 'wishlist-taken';
    const localData = JSON.parse(localStorage.getItem(storageKey) || '{}');

    async function fetchMarkdownAndRender() {
      const url = 'https://cdn.jsdelivr.net/gh/4ME280-Webdesign-a-uzivatelska-rozhrani/SlabaDavidjan-wishlist@main/wishlist.md';
      const res = await fetch(url);
      const text = await res.text();

      const items = [...text.matchAll(/\-\s*\[([^\]]+)\]\(([^)]+)\)\s*!?\[.*?\]\(([^)]+)\)/g)].map(match => ({
        title: match[1],
        url: match[2],
        image: match[3]
      }));

      const ul = document.getElementById('wishlist');
      ul.innerHTML = '';

      items.forEach((item) => {
        const li = document.createElement('li');
        const isTaken = localData[item.title];
        li.className = isTaken ? 'taken' : '';
        li.innerHTML = `
          <h2>${item.title}</h2>
          <a href="${item.url}" target="_blank">${item.url}</a><br/>
          <img src="${item.image}" alt="${item.title}" /><br/>
          ${isTaken ? `<strong>üîí Zabr√°no: ${isTaken}</strong>` : `<button>Zabrat</button>`}
        `;
        if (!isTaken) {
          li.querySelector('button').addEventListener('click', () => {
            const name = prompt('Zadej sv√© jm√©no:');
            if (name) {
              localData[item.title] = name;
              localStorage.setItem(storageKey, JSON.stringify(localData));
              fetchMarkdownAndRender();
            }
          });
        }
        ul.appendChild(li);
      });
    }

    fetchMarkdownAndRender();
  </script>
</body>
</html>


