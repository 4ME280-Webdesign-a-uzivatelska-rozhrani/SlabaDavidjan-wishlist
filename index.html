<script>
let data = [];

fetch('https://api.jsonbin.io/v3/b/683040cb8a456b7966a44a23/latest', {
  headers: {
    'X-Master-Key': '$2a$10$WP0N5E0S.72hHHBH.SjaCOkTpX4vki2XIyZahyb2JcrTwLa2EBUS2'
  }
})
  .then(res => res.json())
  .then(json => {
    data = json.record; // <-- TADY JE KLÍČOVÁ ZMĚNA
    const container = document.getElementById('wishlist');

    data.forEach((item, index) => {
      const div = document.createElement('div');
      div.innerHTML = `
        <h3>${item.name}</h3>
        <img src="${item.image}" style="max-width: 200px;" />
        <p><a href="${item.url}" target="_blank">Odkaz na dárek</a></p>
        <p><strong>Rezervoval:</strong> ${item.buyer || 'zatím nikdo'}</p>
        <input type="text" id="buyer-${index}" placeholder="Zadej své jméno" />
        <button onclick="reserve(${index})">Rezervovat</button>
        <hr>
      `;
      container.appendChild(div);
    });
  });

async function reserve(index) {
  const input = document.getElementById(`buyer-${index}`);
  const name = input.value.trim();
  if (!name) return alert('Zadej jméno');

  data[index].buyer = name;

  await fetch('https://api.jsonbin.io/v3/b/683040cb8a456b7966a44a23', {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'X-Master-Key': 'TVŮJ_MASTER_KEY'
    },
    body: JSON.stringify(data)
  });

  alert('Rezervováno!');
  location.reload();
}
</script>

